<div
  class="relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded"
>
  <div class="rounded-t mb-0 px-4 py-3 border-0">
    <div class="flex flex-wrap items-center">
      <div class="relative w-full px-4 max-w-full flex-grow flex-1">
        <div class="flex flex-row justify-between">
          <h3 class="font-normal text-base text-slate-700 mb-2 text-xl">KYC Application: 
            <span class="text-slate-800 text-md font-semibold">{{applicationId}}</span></h3>
            <div class="flex flex-wrap">
              <button
              class="bg-emerald-400 text-white active:bg-slate-600 disabled:bg-emerald-400 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-3 ease-linear transition-all duration-150"
              type="button"
              (click)="onSave()"
            >
              Save
            </button>
            <button
              class="bg-red-500 text-white active:bg-slate-600 disabled:bg-emerald-400 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-2 ease-linear transition-all duration-150"
              type="button"
              (click)="onDelete()"
            >
              Delete
            </button>
            </div>
        </div>

        <app-progressbar-application
          stepOneName="Company Details"
          stepOne="{{steps[0].progress}}"
          stepTwoName="Proof of Business"
          stepTwo="{{steps[1].progress}}"
          stepThreeName="Address"
          stepThree="{{steps[2].progress}}"
          stepFourName="Proof of Address"
          stepFour="{{steps[3].progress}}"
          stepFiveName="Contact"
          stepFive="{{steps[4].progress}}"
          stepSixName="Declaration"
          stepSix="{{steps[5].progress}}"
        ></app-progressbar-application>
        
        <hr class="mt-6 border-b-1 border-slate-300" />
        
        <div class="flex-auto px-4 lg:px-4 py-10 pt-2">
          <form [formGroup]="businessApplicationForm">

            <div *ngIf="step === 1">
            <h6 class="text-slate-400 text-sm mt-3 mb-6 font-bold uppercase">
              Company Details
            </h6>
            <div class="flex flex-wrap">
              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Company Name
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="Company Name"
                    formControlName="companyName"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Employee First Name
                  </label>
                  <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="First Name"
                  formControlName="employeeFirstName"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Employee Last Name
                  </label>
                  <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="Last Name"
                  formControlName="employeeLastName"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mt-3 mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Date of Incorporation
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="MM/DD/YYYY"
                    formControlName="dateOfIncorporation"
                    (keydown)="onDateIncorporationKey($event)"
                    maxlength="10"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mt-3 mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    State of Incorporation
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="State"
                    formControlName="stateOfIncorporation"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mt-3 mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Registration Number
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="Registration No"
                    formControlName="registrationNumber"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mt-3 mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Date of Commencement
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="MM/DD/YYYY"
                    formControlName="dateOfCommencement"
                    (keydown)="onDateCommencementKey($event)"
                    maxlength="10"
                  />
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mt-3 mb-3 justify-between">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Company Type
                  </label>
                  <select 
                      formControlName="companyType" 
                      class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                      >
                      <option hidden value="" disabled selected>Select Company Type</option>
                        <option 
                          *ngFor="let type of businessTypes | orderBy: 'name'"
                          [value]="type.code"
                        >
                        {{type.name}}
                        </option>
                  </select>
                </div>
              </div>
            </div>
          </div>

        <div *ngIf="step === 2">
          <h6 class="text-slate-400 text-sm mt-3 font-bold uppercase">
            Proof of Business
          </h6>
          <p class="text-slate-600 text-sm mt-1 mb-6 font-semibold">Must provide a document for company identification</p>
         
          <div class="flex flex-wrap">
            <div class="relative w-full mt-3 mb-3 justify-between">
              <label
                class="block text-slate-600 text-sm font-bold mb-2"
              >
                Choose your document type
              </label>

              <div class="form-check inline-block ml-3">
                <input 
                  class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                  type="radio" 
                  name="pobType" 
                  id="radioPassport" 
                  value="PP"
                  formControlName="pobType"
                >
                <label class="form-check-label inline-block text-sm text-slate-700" for="radioPassport">Passport</label>
              </div>
              <div class="form-check inline-block ml-3">
                <input 
                  class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                  type="radio" 
                  name="pobType" 
                  id="radioDL" 
                  value="DL"
                  formControlName="pobType"
                >
                <label class="form-check-label inline-block text-sm text-slate-700" for="radioDL">Driver's License</label>
              </div>
              <div class="form-check inline-block ml-3">
                <input 
                  class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                  type="radio" 
                  name="pobType" 
                  id="radioIDCard" 
                  value="ID"
                  formControlName="pobType"
                >
                <label class="form-check-label inline-block text-sm text-slate-700" for="radioIDCard">ID Card</label>
              </div>
              <div class="form-check inline-block ml-3">
                <input 
                  class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                  type="radio" 
                  name="pobType" 
                  id="radioRP" 
                  value="RP"
                  formControlName="pobType"
                >
                <label class="form-check-label inline-block text-sm text-slate-700" for="radioRP">Residence Permit</label>
              </div>
            </div>
          </div>
          <div class="flex flex-col items-center">
            <p class="text-center text-sm mt-6 mb-1 font-semibold">Upload a photo of your document that is bright and clear (good quality) and fully visible.</p>
            <p class="text-center text-sm mt-1 mb-6 font-normal">Upload .jpg/.jpeg/.png file less than 10MB.</p>
          </div>
          <div class='flex items-center justify-center w-full'>
            <label class="flex flex-col border-4 border-slate-100 border-dashed w-full h-32 hover:bg-slate-50 hover:border-sky-200">
                <div class='flex flex-col items-center pt-8'>
                  <i class="fas fa-id-card fa-2xl mt-3 mb-3"></i>
                  <p class='lowercase text-sm text-slate-500 group-hover:text-red-600 pt-2 tracking-wide'>{{pobLabel}}</p>
                </div>
              <input type='file' class="hidden" value="proofOfBusiness" (change)="handlePobFileInput($event.target.files)" />
            </label>
          </div>
        </div>

        <div *ngIf="step === 3">
          <h6 class="text-slate-400 text-sm mt-3 mb-6 font-bold uppercase">
            Address Details
          </h6>
          <p class="text-slate-600 text-sm mt-1 mb-6 font-semibold">Company Address (Headquarters)</p>
          <div class="flex flex-wrap">
            <div class=" w-full lg:w-6/12 px-4 flex flex-grow gap-6">
              <div class="relative w-full mb-3">
                <label
                  class="block uppercase text-slate-600 text-xs font-bold mb-2 mr-4"
                >
                  Address
                </label>
                <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-white rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="Street Address"
                  formControlName="address"
                />
                <div *ngIf="businessApplicationForm.controls['address'].invalid && (businessApplicationForm.controls['address'].touched)" 
                  class="text-sm text-red-500 mt-1">
                  <div *ngIf="businessApplicationForm.controls['address'].errors.required">
                    Please enter address
                  </div>
                </div>
              </div>
            
              <div class="relative w-6/12 mb-3">
                <label
                  class="block uppercase text-slate-600 text-xs font-bold mb-2"
                >
                  City
                </label>
                <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-white rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="City"
                  formControlName="city"
                />
                <div *ngIf="businessApplicationForm.controls['city'].invalid && (businessApplicationForm.controls['city'].touched)" 
                  class="text-sm text-red-500 mt-1">
                  <div *ngIf="businessApplicationForm.controls['city'].errors.required">
                    Please enter city
                  </div>
                </div>
              </div>

              <div class="relative w-18 mb-3">
                <label
                  class="block uppercase text-slate-600 text-xs font-bold mb-2"
                >
                  State
                </label>
                <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-white rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="ST"
                  formControlName="state"
                />
                <div *ngIf="businessApplicationForm.controls['state'].invalid && (businessApplicationForm.controls['state'].touched)" 
                  class="text-sm text-red-500 mt-1">
                  <div *ngIf="businessApplicationForm.controls['state'].errors.required">
                    Please enter state
                  </div>
                </div>
              </div>

              <div class="relative w-6/12 mb-3">
                <label
                  class="block uppercase text-slate-600 text-xs font-bold mb-2"
                >
                  Postal Code
                </label>
                <input
                  type="text"
                  class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-white rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                  placeholder="Postal Code"
                  formControlName="postalCode"
                />
                <div *ngIf="businessApplicationForm.controls['postalCode'].invalid && (businessApplicationForm.controls['postalCode'].touched)" 
                  class="text-sm text-red-500 mt-1">
                  <div *ngIf="businessApplicationForm.controls['postalCode'].errors.required">
                    Please enter postal code
                  </div>
                  <div *ngIf="businessApplicationForm.controls['postalCode'].errors.pattern">
                    Please enter a valid postal code
                  </div>
                </div>
              </div>
          
              <div class="relative w-6/12 mb-3">
                <label
                  class="block uppercase text-slate-600 text-xs font-bold mb-2"
                >
                  Country
                </label>
                <select 
                formControlName="country" 
                class="border-0 px-3 py-3 placeholder-slate-300 text-slate-600 bg-white rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                >
                  <option hidden value="" disabled selected>Select Country</option>
                  <option 
                    *ngFor="let country of countries | orderBy: 'name'"
                    [value]="country.code"
                  >
                  {{country.name}}
                  </option>
              </select>
              </div>
            </div>
          </div>
          </div>

          <div *ngIf="step === 4">
            <h6 class="text-slate-400 text-sm mt-3 font-bold uppercase">
              Proof of Address
            </h6>
            <p class="text-slate-600 text-sm mt-1 mb-6 font-semibold">Must provide a document for address verification</p>
           
            <div class="flex flex-wrap">
              <div class="relative w-full mt-3 mb-3 justify-between">
                <label
                  class="block text-slate-600 text-sm font-bold mb-2"
                >
                  Choose your document type
                </label>
  
                <div class="form-check inline-block ml-3">
                  <input 
                    class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                    type="radio" 
                    name="poaType" 
                    id="radioUB" 
                    value="UB"
                    formControlName="poaType"
                  >
                  <label class="form-check-label inline-block text-sm text-slate-700" for="radioUB">Utility Bill (less than 3 months old)</label>
                </div>
                <div class="form-check inline-block ml-3">
                  <input 
                    class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                    type="radio" 
                    name="poaType" 
                    id="radioBS" 
                    value="BS"
                    formControlName="poaType"
                  >
                  <label class="form-check-label inline-block text-sm text-slate-700" for="radioBS">Bank Statement (less than 3 months old)</label>
                </div>
                <div class="form-check inline-block ml-3">
                  <input 
                    class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                    type="radio" 
                    name="poaType" 
                    id="radioLA" 
                    value="LA"
                    formControlName="poaType"
                  >
                  <label class="form-check-label inline-block text-sm text-slate-700" for="radioLA">Lease Agreement</label>
                </div>
                <div class="form-check inline-block ml-3">
                  <input 
                    class="form-check-input form-check-input appearance-none rounded-full h-4 w-4 border border-gray-300 bg-white checked:bg-blue-600 checked:border-blue-600 focus:outline-none focus:ring-0 transition duration-200 mt-1 align-top bg-no-repeat bg-center bg-contain float-left mr-2 cursor-pointer" 
                    type="radio" 
                    name="poaType" 
                    id="radioLI" 
                    value="LI"
                    formControlName="poaType"
                  >
                  <label class="form-check-label inline-block text-sm text-slate-700" for="radioLI">Life Insurance Policy</label>
                </div>
              </div>
            </div>
            <div class="flex flex-col items-center">
              <p class="text-center text-sm mt-6 mb-1 font-semibold">Upload a document that is bright and clear (good quality) and fully visible.</p>
              <p class="text-center text-sm mt-1 mb-6 font-normal">Upload .jpg/.jpeg/.png/.doc/.pdf file less than 10MB.</p>
            </div>
            
            <div class='flex items-center justify-center w-full'>
              <label class="flex flex-col border-4 border-slate-100 border-dashed w-full h-32 hover:bg-slate-50 hover:border-sky-200">
                  <div class='flex flex-col items-center pt-8'>
                    <i class="fas fa-file-image fa-2xl mt-3 mb-3"></i>
                    <p class='lowercase text-sm text-slate-500 group-hover:text-red-600 pt-2 tracking-wide'>{{poaLabel}}</p>
                  </div>
                <input type='file' class="hidden" value="proofOfAddress" (change)="handlePoaFileInput($event.target.files)" />
              </label>
          </div>
          </div>

          <div *ngIf="step === 5">
            <h6 class="text-slate-400 text-sm mt-3 mb-6 font-bold uppercase">
              Employee Contact Information
            </h6>
            <div class="flex flex-wrap">
              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Email
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="Email"
                    formControlName="employeeEmail"
                  />
                  <div *ngIf="businessApplicationForm.controls['employeeEmail'].invalid && (businessApplicationForm.controls['employeeEmail'].touched)" 
                      class="text-sm text-red-500 mt-1">
                      <div *ngIf="businessApplicationForm.controls['employeeEmail'].errors.required">
                        Please enter email
                      </div>
                      <div *ngIf="businessApplicationForm.controls['employeeEmail'].errors.email">
                        Please enter a valid email address
                      </div>
                  </div>
                </div>
              </div>

              <div class="w-full lg:w-6/12 px-4">
                <div class="relative w-full mb-3">
                  <label
                    class="block uppercase text-slate-600 text-xs font-bold mb-2"
                  >
                    Phone Number
                  </label>
                  <input
                    type="text"
                    class="border-0 px-3 py-3 placeholder-slate-400 text-slate-600 bg-slate-100 rounded text-sm shadow focus:outline-none focus:ring-0 w-full ease-linear transition-all duration-150"
                    placeholder="XXX-XXX-XXXX"
                    formControlName="employeePhone"
                  />
                  <div *ngIf="businessApplicationForm.controls['employeePhone'].invalid && (businessApplicationForm.controls['employeePhone'].touched)" 
                      class="text-sm text-red-500 mt-1">
                      <div *ngIf="businessApplicationForm.controls['employeePhone'].errors.required">
                        Please enter phone number
                      </div>
                      <div *ngIf="businessApplicationForm.controls['employeePhone'].errors.pattern">
                        Please enter a valid phone number
                      </div>
                  </div>
                </div>
              </div>
            </div>
            </div>

            <div *ngIf="step === 6 && !showApplicationReview">
              <h6 class="text-slate-400 text-sm mt-3 mb-1 font-bold uppercase">
                KYC Declaration
              </h6>
              <div>
                <label class="inline-flex cursor-pointer mt-6 px-2">
                  <input
                    type="checkbox"
                    class="form-checkbox border-0 focus:ring-0 bg-slate-200 text-slate-700 ml-1 w-5 h-5 ease-linear transition-all duration-150 rounded"
                    formControlName="isDeclared"
                    required
                  />
                  <p class="ml-2 text-slate-600 text-sm mb-6 font-normal">
                    I <span class="font-bold">{{businessApplicationForm.value.employeeFirstName}} {{businessApplicationForm.value.employeeLastName}}</span> hereby declare on behalf of <span class="font-bold">{{businessApplicationForm.value.companyName}}</span> that the information provided 
                    is true and correct to the best of my knowledge and belief. I also confirm that in the event of any information provided by our company is found incorrect and/or in the event of any violation of Government 
                    Regulation related to the Bank Secrecy Act (BSA) of 1970 it will be within the right of said Financial Institution to reject/discontinue their customer
                    relationship with <span class="font-bold">{{businessApplicationForm.value.companyName}}</span> and may initiate legal action applicable under provisions if necessary.
                  </p>
                </label>
              </div>
            </div>

            <div *ngIf="showApplicationReview">
              <app-card-review-application
                applicationDetails="{{applicationDetails | stringify}}"
              ></app-card-review-application>
            </div>

          <div class="{{ showPreviousButton() ? 'flex justify-between' : 'text-right' }} mt-6">
            <button
              *ngIf="showPreviousButton()"
              class="bg-sky-500 text-white active:bg-slate-600 disabled:bg-emerald-400 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
              type="button"
              (click)="previousStep()"
            >
            <i class="fas fa-arrow-left fa-lg mt-3 mr-2"></i>
              Previous
            </button>

            <button
              class="{{forwardButtonColor}} text-white active:bg-slate-600 disabled:bg-emerald-400 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
              type="button"
              (click)="nextStep()"
              [disabled]="step === 6 && !businessApplicationForm.value.isDeclared"
            >
              {{forwardButtonText}}
              <i *ngIf="!showApplicationReview" class="fas fa-arrow-right fa-lg mt-3 ml-2"></i>
            </button>
          </div>
        </form>
        </div>
    </div>
  </div>
  <ngx-loading [show]="isLoading" [config]="{ backdropBorderRadius: '3px', backdropBackgroundColour: 'rgba(0, 0, 0, 0.5)'}"></ngx-loading>
</div>
